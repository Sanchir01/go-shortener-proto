syntax = "proto3";

package auth;

option go_package = "shortener.auth.v1;authv1";
import "google/api/annotations.proto";
import "google/api/http.proto";
service Auth {
  rpc Register (RegisterRequest) returns (RegisterResponse){
    option (google.api.http) = {
      post: "/api/v1/auth/register"
      body: "*"
    };
  }
  rpc Login (LoginRequest) returns (LoginResponse){
    option (google.api.http) = {
      post: "/api/v1/auth/login"
      body: "*"
    };
  };
  rpc ConfirmRegister(ConfirmRegisterRequest) returns (ConfirmRegisterResponse){
    option (google.api.http) = {
      post: "/api/v1/auth/confirm"
      body: "*"
    };
  };

}

message RegisterRequest {
  string phone = 1;
  string email = 2;
  string password = 3;
  string title = 4;
}
message RegisterResponse{
  string ok = 1;
}
message LoginRequest {
  string email = 1;
  string password = 2;
}
message LoginResponse {
    string email = 1;
    string phone = 2;
    string title = 3;
    Role role = 4;
}
message ConfirmRegisterRequest {
  string phone = 1;
  string email = 2;
  string password = 3;
  string title = 4;
  string code = 5;
}
message  ConfirmRegisterResponse {
  string email = 1;
  string phone = 2;
  string title = 3;
  Role role = 4;
}
enum Role {
  ROLE_UNSPECIFIED = 0;
  ADMIN = 1;
  USER = 2;
}